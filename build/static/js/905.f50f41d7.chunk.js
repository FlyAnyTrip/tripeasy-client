"use strict";(self.webpackChunktravel_package=self.webpackChunktravel_package||[]).push([[905],{4619:(s,e,a)=>{a.d(e,{A:()=>c});var r=a(5043),i=a(579);const c=function(s){let{children:e,animation:a="fade-up",delay:c=0,duration:n=800,threshold:t=.2,className:l="",once:o=!0}=s;const[m,p]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),h=(0,r.useRef)(null);(0,r.useEffect)((()=>{const s=h.current;if(!s)return;const e=new IntersectionObserver((s=>{const[e]=s;if(e.isIntersecting){if(o&&d)return;p(!0),u(!0)}else o||p(!1)}),{threshold:t,rootMargin:"0px"});return e.observe(s),()=>{s&&e.unobserve(s)}}),[t,o,d]);const y={animationDelay:`${c}ms`,animationDuration:`${n}ms`};return(0,i.jsx)("div",{ref:h,className:`animated-element ${a} ${m?"animate":""} ${l}`,style:y,children:e})}},8636:(s,e,a)=>{a.r(e),a.d(e,{default:()=>m});var r=a(5043),i=a(3216),c=a(5475),n=a(4619),t=a(7221);const l=a.p+"static/media/cashfree-logo.5383fdd43b9b74851c9d.png";var o=a(579);const m=function(){const{id:s}=(0,i.g)(),e=(0,i.zy)(),a=(0,i.Zp)(),{bookingDetails:m,packageDetails:p,totalPrice:d}=e.state||{},[u,h]=(0,r.useState)({processing:!1,success:!1,error:!1,message:""}),[y,j]=(0,r.useState)(!1),[x,f]=(0,r.useState)(""),[N,v]=(0,r.useState)("info"),[g,b]=(0,r.useState)(""),[k,w]=(0,r.useState)(null),[S,P]=(0,r.useState)(!1),[C,I]=(0,r.useState)(!1),$=()=>{P(!S)};(0,r.useEffect)((()=>{if(window.scrollTo({top:0,behavior:"smooth"}),!m||!p)return void a(`/package/${s}`);C&&(console.log("Detected return from payment gateway, resetting payment status"),I(!1),h({processing:!1,success:!1,error:!1,message:""}),document.body.classList.remove("pp-body-blur"));const e=new URLSearchParams(window.location.search).get("order_id");return e&&D(e),()=>{document.body.classList.remove("pp-body-blur")}}),[m,p,s,a,C]),(0,r.useEffect)((()=>{const s=()=>{h({processing:!1,success:!1,error:!1,message:""}),document.body.classList.remove("pp-body-blur")};return window.addEventListener("popstate",s),()=>{window.removeEventListener("popstate",s)}}),[]);const D=async e=>{document.body.classList.add("pp-body-blur"),h({processing:!0,success:!1,error:!1,message:"Verifying payment..."});try{const r=await fetch(`/api/verify-payment/${e}`,{method:"GET",headers:{"Content-Type":"application/json","x-api-version":"2023-08-01"}}),i=await r.json();if(!r.ok)throw console.error("Payment verification error:",i),document.body.classList.remove("pp-body-blur"),new Error("Payment verification failed");if("PAID"===i.status){if(!g){const e=`TP${s}B${Math.floor(1e4*Math.random())}`;b(e)}m&&p&&(console.log("Storing booking details in sessionStorage before redirect"),sessionStorage.setItem("currentPackageId",s),sessionStorage.setItem(`bookingDetails_${s}`,JSON.stringify(m)),sessionStorage.setItem(`packageDetails_${s}`,JSON.stringify(p)),sessionStorage.setItem(`totalPrice_${s}`,JSON.stringify(d))),document.body.classList.remove("pp-body-blur"),h({processing:!1,success:!0,error:!1,message:"Payment successful! Your booking is confirmed."}),f("Payment successful! Your booking is confirmed."),v("success"),j(!0);const r=encodeURIComponent(JSON.stringify(m)),i=encodeURIComponent(JSON.stringify(p));setTimeout((()=>{a(`/payment-status?order_id=${e}&bookingData=${r}&packageData=${i}`)}),1500)}else document.body.classList.remove("pp-body-blur"),h({processing:!1,success:!1,error:!0,message:`Payment not successful. Status: ${i.status}`}),f(`Payment not successful. Status: ${i.status}`),v("error"),j(!0)}catch(r){console.error("Error verifying payment:",r),document.body.classList.remove("pp-body-blur"),h({processing:!1,success:!1,error:!0,message:"Payment verification failed. Please contact support."}),f("Payment verification failed. Please contact support."),v("error"),j(!0)}};return m&&p?(0,o.jsxs)("div",{className:"pp-payment-page",children:[(0,o.jsx)("div",{className:"pp-payment-header",children:(0,o.jsx)("div",{className:"container",children:(0,o.jsxs)(n.A,{animation:"fade-up",children:[(0,o.jsx)("h1",{className:"pp-page-title",children:"Payment"}),(0,o.jsxs)("p",{className:"pp-page-subtitle",children:["Complete your booking for ",p.name]})]})})}),(0,o.jsx)("div",{className:"container",children:u.success?(0,o.jsxs)("div",{className:"pp-payment-success",children:[(0,o.jsx)("div",{className:"pp-success-icon pp-animated-success-icon",children:(0,o.jsx)("i",{className:"fas fa-check-circle"})}),(0,o.jsx)("h2",{children:"Booking Confirmed!"}),(0,o.jsxs)("p",{children:["Your payment of \u20b9",d.toLocaleString("en-IN")," has been processed successfully."]}),(0,o.jsxs)("p",{children:["A confirmation email has been sent to ",m.email,"."]}),(0,o.jsxs)("p",{children:["Your booking reference: ",(0,o.jsx)("strong",{children:g})]}),(0,o.jsxs)("div",{className:"pp-success-actions",children:[(0,o.jsxs)(c.N_,{to:"/",className:"pp-home-button",children:[(0,o.jsx)("i",{className:"fas fa-home"})," Return to Home"]}),(0,o.jsxs)(c.N_,{to:"/packages",className:"pp-browse-button",children:[(0,o.jsx)("i",{className:"fas fa-search"})," Browse More Packages"]})]})]}):(0,o.jsxs)("div",{className:"pp-payment-container",children:[(0,o.jsx)(n.A,{animation:"fade-up",delay:100,children:(0,o.jsxs)("div",{className:"pp-order-summary",children:[(0,o.jsxs)("div",{className:"pp-order-summary-header",children:[(0,o.jsx)("i",{className:"fas fa-receipt pp-summary-icon"}),(0,o.jsx)("h2",{className:"pp-summary-title",children:"Order Summary"})]}),(0,o.jsxs)("div",{className:"pp-summary-details",children:[(0,o.jsxs)("div",{className:"pp-summary-item",children:[(0,o.jsxs)("div",{className:"pp-summary-item-icon-wrapper",children:[(0,o.jsx)("i",{className:"fas fa-map-marked-alt pp-summary-item-icon"}),(0,o.jsx)("span",{className:"pp-summary-label",children:"Package:"})]}),(0,o.jsx)("span",{className:"pp-summary-value",children:p.name})]}),(0,o.jsxs)("div",{className:"pp-summary-item",children:[(0,o.jsxs)("div",{className:"pp-summary-item-icon-wrapper",children:[(0,o.jsx)("i",{className:"fas fa-map-marker-alt pp-summary-item-icon"}),(0,o.jsx)("span",{className:"pp-summary-label",children:"Destination:"})]}),(0,o.jsx)("span",{className:"pp-summary-value",children:p.location})]}),(0,o.jsxs)("div",{className:"pp-summary-item",children:[(0,o.jsxs)("div",{className:"pp-summary-item-icon-wrapper",children:[(0,o.jsx)("i",{className:"fas fa-calendar-alt pp-summary-item-icon"}),(0,o.jsx)("span",{className:"pp-summary-label",children:"Duration:"})]}),(0,o.jsxs)("span",{className:"pp-summary-value",children:[p.duration," Days"]})]}),(0,o.jsxs)("div",{className:"pp-summary-item",children:[(0,o.jsxs)("div",{className:"pp-summary-item-icon-wrapper",children:[(0,o.jsx)("i",{className:"fas fa-calendar-day pp-summary-item-icon"}),(0,o.jsx)("span",{className:"pp-summary-label",children:"Travel Date:"})]}),(0,o.jsx)("span",{className:"pp-summary-value",children:m.travelDate})]}),(0,o.jsxs)("div",{className:"pp-summary-item",children:[(0,o.jsxs)("div",{className:"pp-summary-item-icon-wrapper",children:[(0,o.jsx)("i",{className:"fas fa-users pp-summary-item-icon"}),(0,o.jsx)("span",{className:"pp-summary-label",children:"Travelers:"})]}),(0,o.jsx)("span",{className:"pp-summary-value",children:m.travelers})]}),(0,o.jsxs)("div",{className:"pp-summary-item",children:[(0,o.jsxs)("div",{className:"pp-summary-item-icon-wrapper",children:[(0,o.jsx)("i",{className:"fas fa-tag pp-summary-item-icon"}),(0,o.jsx)("span",{className:"pp-summary-label",children:"Price per person:"})]}),(0,o.jsxs)("span",{className:"pp-summary-value",children:["\u20b9",p.price.toLocaleString("en-IN")]})]}),(0,o.jsxs)("div",{className:"pp-summary-item pp-total",children:[(0,o.jsxs)("div",{className:"pp-summary-item-icon-wrapper",children:[(0,o.jsx)("i",{className:"fas fa-money-bill-wave pp-summary-item-icon"}),(0,o.jsx)("span",{className:"pp-summary-label",children:"Total Amount:"})]}),(0,o.jsxs)("span",{className:"pp-summary-value",children:["\u20b9",d.toLocaleString("en-IN")]})]})]}),(0,o.jsxs)("div",{className:"pp-customer-details",children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("i",{className:"fas fa-user-circle pp-customer-icon"})," ","Customer Details"]}),(0,o.jsxs)("div",{className:"pp-customer-info",children:[(0,o.jsxs)("div",{className:"pp-customer-info-item",children:[(0,o.jsx)("i",{className:"fas fa-user"}),(0,o.jsx)("span",{children:m.fullName})]}),(0,o.jsxs)("div",{className:"pp-customer-info-item",children:[(0,o.jsx)("i",{className:"fas fa-envelope"}),(0,o.jsx)("span",{children:m.email})]}),(0,o.jsxs)("div",{className:"pp-customer-info-item",children:[(0,o.jsx)("i",{className:"fas fa-phone"}),(0,o.jsx)("span",{children:m.phone})]}),(0,o.jsxs)("button",{className:"pp-view-details-button",onClick:$,children:[(0,o.jsx)("i",{className:"fas fa-users"})," View All Travelers"]})]})]})]})}),(0,o.jsx)(n.A,{animation:"fade-up",delay:200,children:(0,o.jsxs)("div",{className:"pp-payment-form-container",children:[(0,o.jsxs)("h2",{className:"pp-form-title",children:[(0,o.jsx)("i",{className:"fas fa-credit-card pp-form-icon"})," Payment Method"]}),(0,o.jsxs)("div",{className:"pp-cashfree-info",children:[(0,o.jsxs)("div",{className:"pp-cashfree-logo",children:[(0,o.jsx)("img",{src:l||"",alt:"Cashfree",className:"pp-cashfree-logo-img"}),(0,o.jsx)("span",{children:"Cashfree Payments"})]}),(0,o.jsx)("p",{children:"Secure payments powered by Cashfree. You'll be redirected to Cashfree's secure payment page to complete your transaction."}),(0,o.jsxs)("div",{className:"pp-payment-methods-supported",children:[(0,o.jsx)("p",{children:"Supported payment methods:"}),(0,o.jsxs)("div",{className:"pp-payment-icons",children:[(0,o.jsxs)("div",{className:"pp-payment-icon",children:[(0,o.jsx)("i",{className:"fas fa-credit-card",title:"Credit/Debit Cards"}),(0,o.jsx)("span",{children:"Cards"})]}),(0,o.jsxs)("div",{className:"pp-payment-icon",children:[(0,o.jsx)("i",{className:"fas fa-mobile-alt",title:"UPI"}),(0,o.jsx)("span",{children:"UPI"})]}),(0,o.jsxs)("div",{className:"pp-payment-icon",children:[(0,o.jsx)("i",{className:"fas fa-university",title:"Net Banking"}),(0,o.jsx)("span",{children:"Net Banking"})]}),(0,o.jsxs)("div",{className:"pp-payment-icon",children:[(0,o.jsx)("i",{className:"fas fa-wallet",title:"Wallets"}),(0,o.jsx)("span",{children:"Wallets"})]})]})]})]}),(0,o.jsxs)("div",{className:"pp-secure-payment-info",children:[(0,o.jsx)("i",{className:"fas fa-shield-alt"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h4",{children:"Secure Payment"}),(0,o.jsx)("p",{children:"Your payment information is secure. We use industry-standard encryption to protect your data."})]})]}),(0,o.jsxs)("div",{className:"pp-form-actions",children:[(0,o.jsxs)(c.N_,{to:`/booking/${s}`,className:"pp-back-link",children:[(0,o.jsx)("i",{className:"fas fa-arrow-left"})," Back to Booking"]}),(0,o.jsxs)("button",{type:"button",className:"pp-pay-button",onClick:async()=>{document.body.classList.add("pp-body-blur"),h({processing:!0,success:!1,error:!1,message:"Preparing your payment..."}),sessionStorage.setItem("currentPackageId",s),sessionStorage.setItem(`bookingDetails_${s}`,JSON.stringify(m)),sessionStorage.setItem(`packageDetails_${s}`,JSON.stringify(p)),sessionStorage.setItem(`totalPrice_${s}`,JSON.stringify(d));const e=await(async()=>{h({processing:!0,success:!1,error:!1,message:"Creating payment order..."});try{const e=`TP${s}B${Math.floor(1e4*Math.random())}`;b(e);const a=await fetch("/api/create-order",{method:"POST",headers:{"Content-Type":"application/json","x-api-version":"2023-08-01"},body:JSON.stringify({amount:d,currency:"INR",customerDetails:{customer_id:`cust_${Date.now()}`,customer_name:m.fullName,customer_email:m.email,customer_phone:m.phone}})}),r=await a.json();if(!a.ok)throw console.error("Server error details:",r),document.body.classList.remove("pp-body-blur"),new Error(r.message||"Failed to create order");return w(r),r}catch(e){return console.error("Error creating order:",e),document.body.classList.remove("pp-body-blur"),h({processing:!1,success:!1,error:!0,message:"Failed to create payment order. Please try again."}),f("Failed to create payment order. Please try again."),v("error"),j(!0),null}})();if(e)if(I(!0),window.Cashfree){const s=new window.Cashfree(e.payment_session_id),a=encodeURIComponent(JSON.stringify(m)),r=encodeURIComponent(JSON.stringify(p));s.redirect({params:{bookingData:a,packageData:r}})}else console.error("Cashfree SDK not loaded"),document.body.classList.remove("pp-body-blur"),h({processing:!1,success:!1,error:!0,message:"Payment gateway not available. Please try again later."}),f("Payment gateway not available. Please try again later."),v("error"),j(!0),I(!1);else document.body.classList.remove("pp-body-blur")},disabled:u.processing,children:[u.processing?"Processing...":`Pay \u20b9${d.toLocaleString("en-IN")}`,!u.processing&&(0,o.jsx)("i",{className:"fas fa-lock"})]})]})]})})]})}),y&&(0,o.jsx)(t.A,{message:x,type:N,onClose:()=>j(!1)}),u.processing&&(0,o.jsx)("div",{className:"pp-centered-loader-overlay",children:(0,o.jsxs)("div",{className:"pp-centered-loader-container",children:[(0,o.jsx)("div",{className:"pp-centered-loader-spinner",children:(0,o.jsx)("div",{className:"pp-spinner-inner"})}),(0,o.jsx)("p",{children:u.message})]})}),S&&(0,o.jsx)("div",{className:"pp-customer-details-modal",children:(0,o.jsxs)("div",{className:"pp-modal-content",children:[(0,o.jsxs)("div",{className:"pp-modal-header",style:{position:"sticky",top:0,backgroundColor:"white",zIndex:10},children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("i",{className:"fas fa-users"})," All Travelers"]}),(0,o.jsx)("button",{className:"pp-modal-close",onClick:$,children:(0,o.jsx)("i",{className:"fas fa-times"})})]}),(0,o.jsx)("div",{className:"pp-modal-body",children:(0,o.jsxs)("div",{className:"pp-traveler-cards",children:[(0,o.jsxs)("div",{className:"pp-traveler-card pp-primary-traveler",children:[(0,o.jsxs)("div",{className:"pp-traveler-card-header",children:[(0,o.jsx)("i",{className:"fas fa-user-circle"}),(0,o.jsx)("h4",{children:"Primary Traveler"})]}),(0,o.jsxs)("div",{className:"pp-traveler-card-body",children:[(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-user"}),(0,o.jsx)("span",{children:m.fullName})]}),(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-envelope"}),(0,o.jsx)("span",{children:m.email})]}),(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-phone"}),(0,o.jsx)("span",{children:m.phone})]}),(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-venus-mars"}),(0,o.jsx)("span",{children:m.gender})]}),(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-birthday-cake"}),(0,o.jsxs)("span",{children:[m.age," years"]})]})]})]}),m.additionalTravelers&&m.additionalTravelers.map(((s,e)=>(0,o.jsxs)("div",{className:"pp-traveler-card",children:[(0,o.jsxs)("div",{className:"pp-traveler-card-header",children:[(0,o.jsx)("i",{className:"fas fa-user"}),(0,o.jsxs)("h4",{children:["Traveler ",e+2]})]}),(0,o.jsxs)("div",{className:"pp-traveler-card-body",children:[(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-user"}),(0,o.jsx)("span",{children:s.fullName})]}),(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-venus-mars"}),(0,o.jsx)("span",{children:s.gender})]}),(0,o.jsxs)("div",{className:"pp-traveler-detail",children:[(0,o.jsx)("i",{className:"fas fa-birthday-cake"}),(0,o.jsxs)("span",{children:[s.age," years"]})]})]})]},e)))]})})]})})]}):(0,o.jsxs)("div",{className:"pp-loading-container",children:[(0,o.jsx)("div",{className:"pp-loading-spinner"}),(0,o.jsx)("p",{children:"Loading payment page..."})]})}}}]);
//# sourceMappingURL=905.f50f41d7.chunk.js.map