"use strict";(self.webpackChunktravel_package=self.webpackChunktravel_package||[]).push([[248,267],{3267:(e,a,i)=>{i.r(a),i.d(a,{default:()=>d});var s=i(5043),t=i(3216),n=i(6910),r=i(8248),l=i(7221),c=i(579);const d=function(){const{id:e}=(0,t.g)(),a=(0,t.Zp)(),i="new"!==e,d=(0,s.useContext)(r.RefreshContext),[o,m]=(0,s.useState)({name:"",price:"",duration:"",image:"",location:"",highlights:[""],description:"",pdfUrl:"",itinerary:[{day:1,title:"",description:"",activities:[""]}],rating:"",reviews:"",category:"",featured:!1}),[h,g]=(0,s.useState)(!1),{showToast:u,ToastContainer:p}=(0,l.d)();(0,s.useEffect)((()=>{localStorage.getItem("adminToken")?i&&e&&"new"!==e&&x():a("/admin/login")}),[e,i,a]);const x=async()=>{try{const r=localStorage.getItem("adminToken"),l=await fetch(`/api/admin/packages/${e}`,{headers:{Authorization:`Bearer ${r}`}});if(401===l.status)return localStorage.removeItem("adminToken"),void a("/admin/login");const c=await l.json();if(c.success){var i,s,t,n;const e=c.data.package;m({...e,price:(null===(i=e.price)||void 0===i?void 0:i.toString())||"",duration:(null===(s=e.duration)||void 0===s?void 0:s.toString())||"",rating:(null===(t=e.rating)||void 0===t?void 0:t.toString())||"",reviews:(null===(n=e.reviews)||void 0===n?void 0:n.toString())||"",highlights:e.highlights&&e.highlights.length>0?e.highlights:[""],itinerary:e.itinerary&&e.itinerary.length>0?e.itinerary:[{day:1,title:"",description:"",activities:[""]}],image:e.image||"",pdfUrl:e.pdfUrl||""})}else u(c.message||"Package not found","error",5e3)}catch(r){u("Failed to fetch package data","error",5e3),console.error("Error fetching package:",r)}},v=e=>{const{name:a,value:i,type:s,checked:t}=e.target;m({...o,[a]:"checkbox"===s?t:i})},j=(e,a,i)=>{const s=[...o.itinerary];s[e]={...s[e],[a]:i},m({...o,itinerary:s})};return(0,c.jsxs)(n.A,{children:[(0,c.jsx)(p,{}),(0,c.jsxs)("div",{className:"admin-package-form",children:[(0,c.jsxs)("div",{className:"form-header",children:[(0,c.jsx)("h1",{children:i?"Edit Package":"Add New Package"}),(0,c.jsx)("button",{type:"button",onClick:()=>a("/admin/dashboard"),className:"btn btn-secondary",children:"Back to Dashboard"})]}),(0,c.jsxs)("form",{onSubmit:async i=>{i.preventDefault(),g(!0);const s=["name","price","duration","location","category","description"].filter((e=>!o[e]||""===o[e].trim()));if(s.length>0)return u(`Please fill in all required fields: ${s.join(", ")}`,"error",5e3),void g(!1);try{const i=localStorage.getItem("adminToken");if(!i)return void a("/admin/login");const s={...o,price:Number(o.price)||0,duration:Number(o.duration)||0,rating:Number(o.rating)||0,reviews:Number(o.reviews)||0,highlights:o.highlights.filter((e=>""!==e.trim())),itinerary:o.itinerary.map((e=>({...e,activities:e.activities?e.activities.filter((e=>""!==e.trim())):[]}))).filter((e=>""!==e.title.trim()||""!==e.description.trim()||e.activities&&e.activities.length>0))};if(isNaN(s.price)||s.price<=0)return u("Please enter a valid price","error",4e3),void g(!1);if(isNaN(s.duration)||s.duration<=0)return u("Please enter a valid duration","error",4e3),void g(!1);const t="new"===e||!e,n=t?"/api/admin/packages":`/api/admin/packages/${e}`,r=t?"POST":"PUT";console.log(`Submitting package data: ${r} ${n}`,s);const l=await fetch(n,{method:r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify(s)}),c=await l.json();console.log("API Response:",c),l.ok&&c.success?(u(t?"Package created successfully!":"Package updated successfully!","success",4e3),d&&d(),a("/admin/dashboard")):u(c.message||"Failed to save package","error",5e3)}catch(t){console.error("Error saving package:",t),u(t.message||"Network error. Please try again.","error",5e3)}finally{g(!1)}},className:"package-form",children:[(0,c.jsxs)("div",{className:"form-section",children:[(0,c.jsx)("h3",{children:"Basic Information"}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"name",children:"Package Name *"}),(0,c.jsx)("input",{type:"text",id:"name",name:"name",value:o.name,onChange:v,required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"location",children:"Location *"}),(0,c.jsx)("input",{type:"text",id:"location",name:"location",value:o.location,onChange:v,required:!0})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"price",children:"Price (\u20b9) *"}),(0,c.jsx)("input",{type:"number",id:"price",name:"price",value:o.price,onChange:v,required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"duration",children:"Duration (days) *"}),(0,c.jsx)("input",{type:"number",id:"duration",name:"duration",value:o.duration,onChange:v,required:!0})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"category",children:"Category *"}),(0,c.jsxs)("select",{id:"category",name:"category",value:o.category,onChange:v,required:!0,children:[(0,c.jsx)("option",{value:"",children:"Select Category"}),(0,c.jsx)("option",{value:"Beach",children:"Beach"}),(0,c.jsx)("option",{value:"Hill Station",children:"Hill Station"}),(0,c.jsx)("option",{value:"International",children:"International"}),(0,c.jsx)("option",{value:"Pilgrimage",children:"Pilgrimage"}),(0,c.jsx)("option",{value:"Heritage",children:"Heritage"}),(0,c.jsx)("option",{value:"Nature & Culture",children:"Nature & Culture"}),(0,c.jsx)("option",{value:"Weekend Trip",children:"Weekend Trip"}),(0,c.jsx)("option",{value:"Luxury",children:"Luxury"}),(0,c.jsx)("option",{value:"Spiritual",children:"Spiritual"})]})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"image",children:"Image URL (Optional)"}),(0,c.jsx)("input",{type:"text",id:"image",name:"image",value:o.image,onChange:v,placeholder:"/src/assets/packages/example.jpg"})]})]}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"rating",children:"Rating (1-5)"}),(0,c.jsx)("input",{type:"number",id:"rating",name:"rating",value:o.rating,onChange:v,min:"1",max:"5",step:"0.1"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"reviews",children:"Number of Reviews"}),(0,c.jsx)("input",{type:"number",id:"reviews",name:"reviews",value:o.reviews,onChange:v})]})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"description",children:"Description *"}),(0,c.jsx)("textarea",{id:"description",name:"description",value:o.description,onChange:v,rows:"4",required:!0})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{htmlFor:"pdfUrl",children:"PDF URL (Optional)"}),(0,c.jsx)("input",{type:"text",id:"pdfUrl",name:"pdfUrl",value:o.pdfUrl,onChange:v,placeholder:"/pdfs/package.pdf"})]}),(0,c.jsx)("div",{className:"form-group",children:(0,c.jsxs)("label",{children:[(0,c.jsx)("input",{type:"checkbox",name:"featured",checked:o.featured,onChange:v}),"Featured Package"]})})]}),(0,c.jsxs)("div",{className:"form-section",children:[(0,c.jsx)("h3",{children:"Highlights"}),o.highlights.map(((e,a)=>(0,c.jsxs)("div",{className:"array-item",children:[(0,c.jsx)("input",{type:"text",value:e,onChange:e=>((e,a,i)=>{const s=[...o[i]];s[e]=a,m({...o,[i]:s})})(a,e.target.value,"highlights"),placeholder:"Enter highlight"}),o.highlights.length>1&&(0,c.jsx)("button",{type:"button",onClick:()=>((e,a)=>{const i=o[a].filter(((a,i)=>i!==e));m({...o,[a]:i})})(a,"highlights"),className:"btn btn-remove",children:"Remove"})]},a))),(0,c.jsx)("button",{type:"button",onClick:()=>function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";m({...o,[e]:[...o[e],a]})}("highlights"),className:"btn btn-add",children:"Add Highlight"})]}),(0,c.jsxs)("div",{className:"form-section",children:[(0,c.jsx)("h3",{children:"Itinerary"}),o.itinerary.map(((e,a)=>(0,c.jsxs)("div",{className:"itinerary-day",children:[(0,c.jsxs)("div",{className:"day-header",children:[(0,c.jsxs)("h4",{children:["Day ",e.day]}),o.itinerary.length>1&&(0,c.jsx)("button",{type:"button",onClick:()=>(e=>{const a=o.itinerary.filter(((a,i)=>i!==e)).map(((e,a)=>({...e,day:a+1})));m({...o,itinerary:a})})(a),className:"btn btn-remove",children:"Remove Day"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Day Title"}),(0,c.jsx)("input",{type:"text",value:e.title,onChange:e=>j(a,"title",e.target.value),placeholder:"Enter day title"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Description"}),(0,c.jsx)("textarea",{value:e.description,onChange:e=>j(a,"description",e.target.value),placeholder:"Enter day description",rows:"3"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"Activities"}),(e.activities||[]).map(((i,s)=>(0,c.jsxs)("div",{className:"array-item",children:[(0,c.jsx)("input",{type:"text",value:i,onChange:e=>((e,a,i)=>{const s=[...o.itinerary];s[e].activities||(s[e].activities=[]),s[e].activities[a]=i,m({...o,itinerary:s})})(a,s,e.target.value),placeholder:"Enter activity"}),e.activities.length>1&&(0,c.jsx)("button",{type:"button",onClick:()=>((e,a)=>{const i=[...o.itinerary];i[e].activities=i[e].activities.filter(((e,i)=>i!==a)),m({...o,itinerary:i})})(a,s),className:"btn btn-remove",children:"Remove"})]},s))),(0,c.jsx)("button",{type:"button",onClick:()=>(e=>{const a=[...o.itinerary];a[e].activities||(a[e].activities=[]),a[e].activities.push(""),m({...o,itinerary:a})})(a),className:"btn btn-add",children:"Add Activity"})]})]},a))),(0,c.jsx)("button",{type:"button",onClick:()=>{const e={day:o.itinerary.length+1,title:"",description:"",activities:[""]};m({...o,itinerary:[...o.itinerary,e]})},className:"btn btn-add",children:"Add Day"})]}),(0,c.jsxs)("div",{className:"form-actions",children:[(0,c.jsx)("button",{type:"submit",disabled:h,className:"btn btn-primary",children:h?"Saving...":i?"Update Package":"Create Package"}),(0,c.jsx)("button",{type:"button",onClick:()=>a("/admin/dashboard"),className:"btn btn-secondary",children:"Cancel"})]})]})]})]})}},6910:(e,a,i)=>{i.d(a,{A:()=>l});var s=i(3216),t=i(5475),n=i(7221),r=i(579);const l=e=>{let{children:a,title:i}=e;const l=(0,s.Zp)(),c=(0,s.zy)(),{success:d,info:o}=(0,n.d)(),m=e=>c.pathname===e||c.pathname.startsWith(e);return(0,r.jsxs)("div",{className:"admin-layout",children:[(0,r.jsx)("header",{className:"admin-header",children:(0,r.jsxs)("div",{className:"admin-header-content",children:[(0,r.jsx)("div",{className:"admin-brand",children:(0,r.jsxs)("h1",{children:[(0,r.jsx)("i",{className:"fas fa-cogs"}),"TripEasy Admin Panel"]})}),(0,r.jsxs)("nav",{className:"admin-nav",children:[(0,r.jsxs)(t.N_,{to:"/admin/dashboard",className:"nav-link "+(m("/admin/dashboard")?"active":""),children:[(0,r.jsx)("i",{className:"fas fa-tachometer-alt"}),"Dashboard"]}),(0,r.jsxs)(t.N_,{to:"/admin/edit/new",className:"nav-link "+(m("/admin/edit/new")?"active":""),children:[(0,r.jsx)("i",{className:"fas fa-plus-circle"}),"Add Package"]}),(0,r.jsxs)(t.N_,{to:"/",className:"nav-link view-site",children:[(0,r.jsx)("i",{className:"fas fa-external-link-alt"}),"View Site"]}),(0,r.jsxs)("button",{onClick:()=>{window.confirm("Are you sure you want to logout?")&&(localStorage.removeItem("adminToken"),localStorage.removeItem("adminLoginTime"),d("Logged out successfully!"),l("/admin/login"))},className:"logout-btn",children:[(0,r.jsx)("i",{className:"fas fa-sign-out-alt"}),"Logout"]})]})]})}),(0,r.jsx)("main",{className:"admin-main",children:(0,r.jsxs)("div",{className:"admin-content",children:[i&&(0,r.jsxs)("div",{className:"page-header",children:[(0,r.jsx)("h2",{className:"page-title",children:i}),(0,r.jsxs)("div",{className:"breadcrumb",children:[(0,r.jsx)(t.N_,{to:"/admin/dashboard",children:"Dashboard"}),i&&"Dashboard"!==i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"separator",children:"/"}),(0,r.jsx)("span",{className:"current",children:i})]})]})]}),a]})})]})}},8248:(e,a,i)=>{i.r(a),i.d(a,{RefreshContext:()=>d,default:()=>o});var s=i(5043),t=i(3216),n=i(5475),r=i(2115),l=(i(2342),i(6910)),c=i(579);const d=(0,s.createContext)(null);const o=function(){const[e,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[m,h]=(0,s.useState)(""),g=(0,t.Zp)(),u=()=>{o(!0),p()};(0,s.useEffect)((()=>{u()}),[]);const p=async()=>{try{const e=localStorage.getItem("adminToken");if(!e)return void g("/admin/login");const i=await fetch("/api/admin/packages",{headers:{Authorization:`Bearer ${e}`}});if(401===i.status)return localStorage.removeItem("adminToken"),void g("/admin/login");const s=await i.json();s.success?a(s.data.packages||[]):h(s.message||"Failed to fetch packages")}catch(m){h("Network error. Please try again."),console.error("Error fetching packages:",m)}finally{o(!1)}};return i?(0,c.jsx)(d.Provider,{value:u,children:(0,c.jsx)(l.A,{children:(0,c.jsxs)("div",{className:"admin-loading-container",children:[(0,c.jsx)("div",{className:"admin-loading-spinner"}),(0,c.jsx)("p",{children:"Loading packages..."})]})})}):(0,c.jsx)(d.Provider,{value:u,children:(0,c.jsxs)(l.A,{children:[(0,c.jsxs)("div",{className:"admin-dashboard-container",children:[(0,c.jsxs)("div",{className:"admin-dashboard-header",children:[(0,c.jsx)("h1",{className:"admin-dashboard-title",children:"Package Management"}),(0,c.jsxs)(n.N_,{to:"/admin/edit/new",className:"admin-add-btn",children:[(0,c.jsx)("i",{className:"fas fa-plus"})," Add New Package"]})]}),m&&(0,c.jsx)("div",{className:"admin-error-message",children:JSON.stringify(m,null,2)}),(0,c.jsx)("div",{className:"admin-packages-grid",children:e.map((e=>{var a;return(0,c.jsxs)("div",{className:"admin-card-box",children:[(0,c.jsxs)("div",{className:"admin-card-header",children:[(0,c.jsxs)("div",{className:"admin-package-info",children:[(0,c.jsx)("h3",{className:"admin-package-name",children:e.name}),(0,c.jsx)("p",{className:"admin-package-location",children:e.location})]}),(0,c.jsxs)("div",{className:"admin-package-actions",children:[(0,c.jsx)(n.N_,{to:`/admin/edit/${e.id}`,className:"admin-edit-btn",title:"Edit Package",children:(0,c.jsx)("i",{className:"fas fa-edit"})}),(0,c.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this package?"))try{const a=localStorage.getItem("adminToken"),i=await fetch(`/api/admin/packages/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),s=await i.json();s.success?(u(),r.oR.success("Package deleted successfully",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,className:"admin-toast-success"})):h(s.message||"Failed to delete package")}catch(m){h("Network error. Please try again."),console.error("Error deleting package:",m)}})(e.id),className:"admin-delete-btn",title:"Delete Package",children:(0,c.jsx)("i",{className:"fas fa-trash"})})]})]}),(0,c.jsxs)("div",{className:"admin-card-body",children:[(0,c.jsxs)("div",{className:"admin-package-details",children:[(0,c.jsxs)("div",{className:"admin-detail-item",children:[(0,c.jsx)("span",{className:"admin-detail-label",children:"Price:"}),(0,c.jsxs)("span",{className:"admin-detail-value",children:["\u20b9",null===(a=e.price)||void 0===a?void 0:a.toLocaleString()]})]}),(0,c.jsxs)("div",{className:"admin-detail-item",children:[(0,c.jsx)("span",{className:"admin-detail-label",children:"Duration:"}),(0,c.jsxs)("span",{className:"admin-detail-value",children:[e.duration," days"]})]}),(0,c.jsxs)("div",{className:"admin-detail-item",children:[(0,c.jsx)("span",{className:"admin-detail-label",children:"Category:"}),(0,c.jsx)("span",{className:"admin-category-badge",children:e.category})]}),(0,c.jsxs)("div",{className:"admin-detail-item",children:[(0,c.jsx)("span",{className:"admin-detail-label",children:"Rating:"}),(0,c.jsxs)("span",{className:"admin-rating-value",children:["\u2b50 ",e.rating," (",e.reviews," reviews)"]})]}),(0,c.jsxs)("div",{className:"admin-detail-item",children:[(0,c.jsx)("span",{className:"admin-detail-label",children:"Featured:"}),(0,c.jsx)("span",{className:"admin-status "+(e.featured?"admin-featured":"admin-not-featured"),children:e.featured?"Yes":"No"})]})]}),e.description&&(0,c.jsx)("div",{className:"admin-package-description",children:(0,c.jsxs)("p",{children:[e.description.substring(0,100),"..."]})})]})]},e.id)}))}),0===e.length&&(0,c.jsxs)("div",{className:"admin-empty-state",children:[(0,c.jsx)("div",{className:"admin-empty-icon",children:(0,c.jsx)("i",{className:"fas fa-box-open"})}),(0,c.jsx)("h3",{children:"No packages found"}),(0,c.jsx)("p",{children:"Get started by adding your first package"}),(0,c.jsx)(n.N_,{to:"/admin/edit/new",className:"admin-add-btn",children:"Add First Package"})]})]}),(0,c.jsx)(r.N9,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})})}}}]);
//# sourceMappingURL=267.811447e8.chunk.js.map